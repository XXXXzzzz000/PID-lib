/**
 * @file    PID_v2.h
 * @brief   pid头文件
 *
 * @addtogroup PID
 * @{
 */

#ifndef PID_v2_h
#define PID_v2_h
/*===========================================================================*/
/* 头文件.                                                                   */
/*===========================================================================*/
#include "hal.h"

/*===========================================================================*/
/* 模块常量宏定义.                                                            */
/*===========================================================================*/

/*===========================================================================*/
/* 模块预编译设置.                                                            */
/*===========================================================================*/

/*===========================================================================*/
/* 派生常量和错误检查.                                                         */
/*===========================================================================*/

/*===========================================================================*/
/* 模块数据结构和类型.                                                         */
/*===========================================================================*/
typedef struct
{
    /* PID参数相关 */
    double kp; /*(P)roportional Tuning Parameter 比例调谐参数*/
    double ki; /*(I)ntegral Tuning Parameter 积分调谐参数*/
    double kd; /*(D)erivative Tuning Parameter 微分调谐参数*/

    double *Input; /* 保存输入输出及设置点 */
    double *Output;
    double *Setpoint;
    /* 采集模式相关控制 */
    int controllerDirection;     /* 反馈与输出是正相关则为DIRECT 反之则为REVERSE*/
    unsigned long lastTime;      /* 上一次的输出 */
    double outputSum, lastInput; /* 输出和,上一次的反馈 */
    unsigned long SampleTime;    /* 采样频率 */
    double outMin, outMax;       /* 输出钳值 */
    bool inAuto, pOnE;           /* pOnE = POn == P_ON_E */
} PID;
/*===========================================================================*/
/* 模块宏函数.                                                                */
/*===========================================================================*/

/*===========================================================================*/
/* 外部声明.                                                                  */
/*===========================================================================*/

/*===========================================================================*/
/* 模块内联函数.                                                              */
/*===========================================================================*/

#endif /* PID_v2_h */

/** @} */